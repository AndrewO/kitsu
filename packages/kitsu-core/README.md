<h1 align=center>Kitsu Core</h1>

<p align=center>
  <a href='https://www.npmjs.com/package/kitsu-core'><img alt='npm' src='https://flat.badgen.net/npm/v/kitsu-core'></a>
  <a href='https://www.npmjs.com/package/kitsu-core'><img alt='npm' src='https://flat.badgen.net/npm/dt/kitsu-core'></a>
  <a href='https://bundlephobia.com/result?p=kitsu-core'><img alt='bundlephobia' src='https://flat.badgen.net/bundlephobia/minzip/kitsu-core'></a>
  <a href='https://david-dm.org/wopian/kitsu?path=packages/kitsu-core'><img alt='deps' src='https://david-dm.org/wopian/kitsu/status.svg?path=packages/kitsu-core&style=flat-square'></a>
</p>

<p align=center>
  <a href='https://travis-ci.org/wopian/kitsu'><img alt='travis' src='https://flat.badgen.net/travis/wopian/kitsu'></a>
  <a href='https://ci.appveyor.com/project/wopian/kitsu'><img alt='appveyor' src='https://flat.badgen.net/appveyor/ci/wopian/kitsu'></a>
  <a href='https://packagephobia.now.sh/result?p=kitsu-core'><img alt='packagephobia' src='https://flat.badgen.net/packagephobia/install/kitsu-core'></a>
  <a href='https://github.com/wopian/kitsu/graphs/contributors'><img alt='contributors' src='https://flat.badgen.net/github/contributors/wopian/kitsu'></a>
</p>

<p align=center>
  <a href='https://codeclimate.com/github/wopian/kitsu/code'><img alt='coverage' src='https://flat.badgen.net/codeclimate/coverage/wopian/kitsu'></a>
  <a href='https://codeclimate.com/github/wopian/kitsu'><img alt='maintainability' src='https://flat.badgen.net/codeclimate/maintainability/wopian/kitsu'></a>
  <a href='https://codeclimate.com/github/wopian/kitsu'><img alt='technical debt' src='https://flat.badgen.net/codeclimate/tech-debt/wopian/kitsu'></a>
  <a href='https://codeclimate.com/github/wopian/kitsu/issues'><img alt='issues' src='https://flat.badgen.net/codeclimate/issues/wopian/kitsu'></a>
</p>

<p align=center>
  <a href='https://paypal.me/wopian'><img alt='support me on paypal.me' src='https://flat.badgen.net/badge/support%20me%20on/paypal.me/pink'></a>
</p>

<p align=center>Core <a src='http://jsonapi.org'>JSON:API</a> serialisation and deserialisation components</p>

<p align=center>Check out the <a src='https://github.com/wopian/kitsu/blob/master/packages/kitsu-core/MIGRATING.md'>Migration Guide</a> for breaking changes in <code>6.x</code></p>

#

## Features

-   JSON-API 1.0 compliant
-   Automatically links relationships to data
-   Works in Node and on the web
-   Uses the [Promise] API

## Node / Browser Support

|             Package | Package<br> Size\* | Node | Chrome | Firefox | Safari | Edge |  IE |
| ------------------: | :----------------: | :--: | :----: | :-----: | :----: | :--: | :-: |
|        `kitsu-core` |     ≤ 4.3 kb       |  6+  |   54+  |   51+   |   10+  |  15+ |     |
|   `kitsu-core/node` |     ≤ 1.5 kb       |  6+  |        |         |        |      |     |

\* Including all dependencies, minified & gzipped<br>

## Install

### Yarn / NPM

```bash
yarn add kitsu-core
npm install kitsu-core
```

```js
import { camel } from 'kitsu-core'      // ES Modules and Babel
import { camel } from 'kitsu-core/node' // Lighter node-only package
const { camel } = require('kitsu-core') // CommonJS and Browserify

camel(...)
```

### Packd CDN

```html
<script src='https://bundle.run/kitsu-core@6?name=kitsuCore'></script>
```

```js
kitsuCore.camel(...)
```

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

-   [camel](#camel)
    -   [Parameters](#parameters)
    -   [Examples](#examples)
-   [deattribute](#deattribute)
    -   [Parameters](#parameters-1)
    -   [Examples](#examples-1)
-   [deserialise](#deserialise)
    -   [Parameters](#parameters-2)
    -   [Examples](#examples-2)
-   [error](#error)
    -   [Parameters](#parameters-3)
-   [filterIncludes](#filterincludes)
    -   [Parameters](#parameters-4)
-   [kebab](#kebab)
    -   [Parameters](#parameters-5)
    -   [Examples](#examples-3)
-   [linkRelationships](#linkrelationships)
    -   [Parameters](#parameters-6)
-   [query](#query)
    -   [Parameters](#parameters-7)
-   [serialise](#serialise)
    -   [Parameters](#parameters-8)
    -   [Examples](#examples-4)
-   [snake](#snake)
    -   [Parameters](#parameters-9)
    -   [Examples](#examples-5)

### camel

Converts kebab-case and snake_case into camelCase

#### Parameters

-   `s` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** String to convert

#### Examples

_Convert kebab-case_

```javascript
camel('hello-world') // 'helloWorld'
```

_Convert snake_case_

```javascript
camel('hello_world') // 'helloWorld'
```

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** camelCase formatted string

### deattribute

Hoists attributes to be top-level

#### Parameters

-   `data` **([Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object) \| [Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array))** Resource data

#### Examples

_Deattribute an array of resources_

```javascript
// JSON:API 'data' field
const data = [
  {
    id: '1',
    type: 'users',
    attributes: { slug: 'wopian' }
  }
]

const output = await deattribute(data) // [ { id: '1', type: 'users', slug: 'wopian' } ]
```

_Deattribute a resource_

```javascript
// JSON:API 'data' field
const data = {
  id: '1',
  type: 'users',
  attributes: { slug: 'wopian' }
}

const output = await deattribute(data) // { id: '1', type: 'users', slug: 'wopian' }
```

Returns **([Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object) \| [Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array))** Deattributed resource data

### deserialise

Deserialises a JSON-API response

#### Parameters

-   `obj` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The response

#### Examples

_Deserialise with a basic data object_

```javascript
await deserialise({
  data: {
    id: '1',
    attributes: { liked: true }
  },
  meta: { hello: 'world' }
}) // { data: { id: '1', liked: true }, meta: { hello: 'world' } }
```

_Deserialise with relationships_

```javascript
await deserialise({
  data: {
    id: '1',
    relationships: {
      user: {
        data: {
          type: 'users',
          id: '2' }
      }
    }
  },
  included: [
    {
      type: 'users',
      id: '2',
      attributes: { slug: 'wopian' }
    }
  ]
}) // { data: { id: '1', user: { type: 'users', id: '2', slug: 'wopian' } } }
```

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The deserialised response

### error

Mutates an error and rethrows it

#### Parameters

-   `E` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The Error


-   Throws **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The mutated Error

### filterIncludes

Filters includes for the specific relationship

#### Parameters

-   `included` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The response included object
-   `opts` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)**
    -   `opts.id` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** The relationship ID
    -   `opts.type` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** The relationship type

Returns **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)** The matched includes

### kebab

Converts camelCase into kebab-case

#### Parameters

-   `s` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** camelCase string

#### Examples

```javascript
kebab('helloWorld') // 'hello-world'
```

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** kekab-case formatted string

### linkRelationships

Links relationships to included data

#### Parameters

-   `data` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The response data object
-   `included` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The response included object

### query

Constructs a URL query string for JSON:API parameters

#### Parameters

-   `params` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Parameters to parse
-   `prefix` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Prefix for nested parameters - used internally (default `null`) (optional, default `null`)

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** URL query string

### serialise

Serialises an object into a JSON-API structure

#### Parameters

-   `model` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Request model
-   `obj` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The data (optional, default `{}`)
-   `method` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Request type (optional, default `'POST'`)

#### Examples

_Due to its usage in kitsu, it **MUST** be called with **this** set in 5.0.x_

```javascript
import { serialise, camel, kebab } from 'kitsu-core'
import plural from 'pluralize'

const output = await serialise.apply({ camel, resCase: kebab, plural }, [ model, obj, 'PATCH' ])
```

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The serialised data

### snake

Converts camelCase into snake_case

#### Parameters

-   `s` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** camelCase string

#### Examples

```javascript
snake('helloWorld') // 'hello_world'
```

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** snake_case formatted string

## Contributing

See [CONTRIBUTING]

## Releases

See [CHANGELOG]

## License

All code released under [MIT]

[json:api]: http://jsonapi.org

[promise]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises

[changelog]: https://github.com/wopian/kitsu/blob/master/packages/kitsu-core/CHANGELOG.md

[contributing]: https://github.com/wopian/kitsu/blob/master/CONTRIBUTING.md

[mit]: https://github.com/wopian/kitsu/blob/master/LICENSE.md
